module ShardWorkerModule {
    typedef sequence<long> long_seq;
    typedef sequence<float> float_seq;
    typedef sequence<string> str_seq;
    typedef sequence<str_seq> str_seq_seq;

    interface ShardWorker {
        long_seq byte_pair_encode(in str_seq shard);
        str_seq_seq sample_sliding_window_data(in long_seq token_ids, in long window_size, in long stride);
        float_seq embed(in long_seq token_ids);
    };
};
